#!/usr/bin/env python3

from glob import glob
from plumbum import FG, local as sh

def main():
    echo = sh['echo']
    pacman = sh['pacman']
    rm = sh['rm']
    rmshit = sh['rmshit']
    sudo = sh['sudo']

    chain = echo['-e', 'y\ny\n'] | sudo[pacman['-Scc']]
    print(chain())

    pkgs = pacman('-Qqdt', retcode=None).split('\n')[:-1]
    if len(pkgs) > 0:
        sudo[pacman['-Rscun', '--noconfirm', pkgs]] & FG

    rm('-rf', glob('/tmp/npm*'))
    rm('-rf', glob('/tmp/yaourt*'))

    rmshit['-vy'] & FG

if __name__ == '__main__':
    try:
        main()
    except KeyboardInterrupt as e:
        pass

